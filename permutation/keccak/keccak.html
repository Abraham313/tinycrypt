<h3><strong>Introduction</strong></h3>

<p><a href="https://github.com/gvanas/KeccakCodePackage">Keccak</a> is a cryptographic permutation function designed by <a href="https://keccak.team/team.html">Guido Bertoni</a>, <a href="http://jda.noekeon.org/">Joan Daemen</a>, <a href="http://mip.noekeon.org/">MichaÃ«l Peeters</a> and <a href="http://gva.noekeon.org/">Gilles Van Assche</a>. Keccak can be used to construct a stream cipher, a cryptographic hash function, a Pseudo Random Number Generator (PRNG), Message Authentication Code (MAC) or Authenticated Encryption. (AE)</p>

<ul>
<li><a href="https://keccak.team/files/Keccak-reference-3.0.pdf">The Keccak Reference</a></li>
<li><a href="https://keccak.team/files/Keccak-implementation-3.2.pdf">Keccak Implementation Overview</a></li>
<li><a href="https://github.com/gvanas/KeccakCodePackage">Keccak Code Package</a></li>
</ul>

<p>Although SHA-3 (<a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">FIPS 202</a>) was covered in a <a href="https://tinycrypt.wordpress.com/2016/03/01/asmcodes-sha3/">previous post</a>, Keccak itself was overlooked. In this post are source codes for Keccak-f[1600,24], Keccak-f[800,22] and Keccak-f[200,18]. I don't cover Keccak-f[400,20] because it's designed for 16-bit architectures. The following x86 assembly code includes optmizations from <a href="http://pferrie.host22.com/">Peter Ferrie</a></p>

<h3><strong>Keccak Parameters</strong></h3>

<p>The following table lists parameters for the Keccak function and what architecture it's most suitable for.</p>

<table border="1">
  <tr>
    <th>F</th>
    <th>Target Architecture</th>
    <th>Capacity</th>
    <th>Rounds</th>
  </tr>
  <tr>
    <td>200</td>
    <td>8-bit</td>
    <td>200-bits</td>
    <td>18</td>
  </tr>
  <tr>
    <td>400</td>
    <td>16-bit</td>
    <td>400-bits</td>
    <td>20</td>
  </tr>
  <tr>
    <td>800</td>
    <td>32-bit</td>
    <td>800-bits</td>
    <td>22</td>
  </tr>
  <tr>
    <td>1600</td>
    <td>64-bit</td>
    <td>1600-bits</td>
    <td>24</td>
  </tr>
</table>

<h3><strong>Keccak Modules</strong></h3>

<table border="1">
  <tr>
    <th>Module</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>Theta</td>
    <td>Renders the internal state into a 5-by-5 array of n-bit elements. Computes the parity of each column and combines them with an exclusive-or (XOR) operator.</td>
  </tr>
  <tr>
    <td>Rho</td>
    <td>Rotates each element by a triangular number.</td>
  </tr>
  <tr>
    <td>Pi</td>
    <td>Permutes the elements.</td>
  </tr>
  <tr>
    <td>Chi</td>
    <td>Adds a non-linear aspect to the permutation round. Combines the row elements using only three bitwise operators: AND, NOT, and XOR.</td>
  </tr>
  <tr>
    <td>Iota</td>
    <td>Breaks up any symmetry caused by the other modules. This is done by XORing one of the array elements to a round constant. Without iota, the round mapping would be symmetric. Without iota, all rounds would be the same.</td>
  </tr>
</table>
 
<h3>Keccak-f[800,22] in C</h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> R</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>|</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>v</span><span style='color:#808030; '>)</span><span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#808030; '>(</span><span style='color:#004a43; '>32</span><span style='color:#808030; '>-</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>n</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
<span style='color:#004a43; '>#</span><span style='color:#004a43; '>define</span><span style='color:#004a43; '> F</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>a</span><span style='color:#808030; '>,</span><span style='color:#004a43; '>b</span><span style='color:#808030; '>)</span><span style='color:#004a43; '>for</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>a</span><span style='color:#808030; '>=</span><span style='color:#004a43; '>0</span><span style='color:#808030; '>;</span><span style='color:#004a43; '>a</span><span style='color:#808030; '>&lt;</span><span style='color:#004a43; '>b</span><span style='color:#808030; '>;</span><span style='color:#004a43; '>a</span><span style='color:#808030; '>+</span><span style='color:#808030; '>+</span><span style='color:#808030; '>)</span>
  
<span style='color:#800000; font-weight:bold; '>void</span> k800<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>void</span><span style='color:#808030; '>*</span>p<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
  <span style='color:#800000; font-weight:bold; '>unsigned</span> <span style='color:#800000; font-weight:bold; '>char</span> R<span style='color:#808030; '>=</span><span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span>
  <span style='color:#800000; font-weight:bold; '>unsigned</span> <span style='color:#800000; font-weight:bold; '>int</span> n<span style='color:#808030; '>,</span>i<span style='color:#808030; '>,</span>j<span style='color:#808030; '>,</span>r<span style='color:#808030; '>,</span>x<span style='color:#808030; '>,</span>y<span style='color:#808030; '>,</span>t<span style='color:#808030; '>,</span>Y<span style='color:#808030; '>,</span>b<span style='color:#808030; '>[</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#808030; '>*</span>s<span style='color:#808030; '>=</span>p<span style='color:#800080; '>;</span>

  F<span style='color:#808030; '>(</span>n<span style='color:#808030; '>,</span><span style='color:#008c00; '>22</span><span style='color:#808030; '>)</span><span style='color:#800080; '>{</span>
    F<span style='color:#808030; '>(</span>i<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#800080; '>{</span>b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>=</span><span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>F<span style='color:#808030; '>(</span>j<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>*</span>j<span style='color:#808030; '>]</span><span style='color:#800080; '>;</span><span style='color:#800080; '>}</span>
    F<span style='color:#808030; '>(</span>i<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#800080; '>{</span>
      t<span style='color:#808030; '>=</span>b<span style='color:#808030; '>[</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>)</span><span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>^</span>R<span style='color:#808030; '>(</span>b<span style='color:#808030; '>[</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
      F<span style='color:#808030; '>(</span>j<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>s<span style='color:#808030; '>[</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>*</span>j<span style='color:#808030; '>]</span><span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>t<span style='color:#800080; '>;</span><span style='color:#800080; '>}</span>
    t<span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>y<span style='color:#808030; '>=</span>r<span style='color:#808030; '>=</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span>x<span style='color:#808030; '>=</span><span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span>
    F<span style='color:#808030; '>(</span>j<span style='color:#808030; '>,</span><span style='color:#008c00; '>24</span><span style='color:#808030; '>)</span>
      r<span style='color:#808030; '>+</span><span style='color:#808030; '>=</span>j<span style='color:#808030; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span>Y<span style='color:#808030; '>=</span>x<span style='color:#808030; '>+</span>x<span style='color:#808030; '>+</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>*</span>y<span style='color:#808030; '>,</span>x<span style='color:#808030; '>=</span>y<span style='color:#808030; '>,</span>y<span style='color:#808030; '>=</span>Y<span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>,</span>
      Y<span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span>x<span style='color:#808030; '>+</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>*</span>y<span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span>x<span style='color:#808030; '>+</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>*</span>y<span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>t<span style='color:#808030; '>,</span>r<span style='color:#808030; '>%</span><span style='color:#008c00; '>32</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>t<span style='color:#808030; '>=</span>Y<span style='color:#800080; '>;</span>
    F<span style='color:#808030; '>(</span>j<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#800080; '>{</span>
      F<span style='color:#808030; '>(</span>i<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>*</span>j<span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
      F<span style='color:#808030; '>(</span>i<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>
        s<span style='color:#808030; '>[</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>*</span>j<span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>^</span><span style='color:#808030; '>(</span>b<span style='color:#808030; '>[</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>&amp;</span><span style='color:#808030; '>~</span>b<span style='color:#808030; '>[</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span><span style='color:#800080; '>}</span>
    F<span style='color:#808030; '>(</span>j<span style='color:#808030; '>,</span><span style='color:#008c00; '>7</span><span style='color:#808030; '>)</span>
      <span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span>R<span style='color:#808030; '>=</span><span style='color:#808030; '>(</span>R<span style='color:#808030; '>+</span>R<span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#008c00; '>113</span><span style='color:#808030; '>*</span><span style='color:#808030; '>(</span>R<span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#008c00; '>7</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>&amp;</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span>
        <span style='color:#808030; '>*</span>s<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span><span style='color:#008c00; '>1</span><span style='color:#006600; '>UL</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span>j<span style='color:#808030; '>)</span><span style='color:#808030; '>-</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
  <span style='color:#800080; '>}</span>
<span style='color:#800080; '>}</span>
</pre>

<h3><strong>Keccak-f[800,22]</strong></h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#004a43;'>bits</span>   <span style='color:#008c00;'>32</span>
  
<span style='color:#004a43;'>struc</span> kws_t
  bc1  <span style='color:#800000;font-weight:bold;'>resd</span> <span style='color:#008c00;'>1</span> <span style='color:#696969;'>; edi</span>
  bc2  <span style='color:#800000;font-weight:bold;'>resd</span> <span style='color:#008c00;'>1</span> <span style='color:#696969;'>; esi</span>
  bc3  <span style='color:#800000;font-weight:bold;'>resd</span> <span style='color:#008c00;'>1</span> <span style='color:#696969;'>; ebp</span>
  bc4  <span style='color:#800000;font-weight:bold;'>resd</span> <span style='color:#008c00;'>1</span> <span style='color:#696969;'>; esp</span>
  bc5  <span style='color:#800000;font-weight:bold;'>resd</span> <span style='color:#008c00;'>1</span> <span style='color:#696969;'>; ebx</span>
  lfsr <span style='color:#800000;font-weight:bold;'>resd</span> <span style='color:#008c00;'>1</span> <span style='color:#696969;'>; edx</span>
  <span style='color:#696969;'>; ecx</span>
  <span style='color:#696969;'>; eax</span>
<span style='color:#e34adc;'>&#xa0;&#xa0;.size:</span>
<span style='color:#004a43;'>endstruc</span>
  
<span style='color:#004a43;'>&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#004a43;'>%ifndef</span><span style='color:#004a43;'> BIN</span>
      <span style='color:#004a43;'>global</span> k800_permutex
      <span style='color:#004a43;'>global</span> _k800_permutex
<span style='color:#004a43;'>&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#004a43;'>%endif</span>
    
<span style='color:#696969;'>; void k800_permutex(void *state);    </span>
<span style='color:#e34adc;'>k800_permutex:</span>
<span style='color:#e34adc;'>_k800_permutex:</span>
    <span style='color:#800000;font-weight:bold;'>pushad</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#000080;'>esi</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esp</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>32</span><span style='color:#008c00;'>+4</span><span style='color:#808030;'>]</span>      <span style='color:#696969;'>; esi = st</span>
    <span style='color:#800000;font-weight:bold;'>call</span>   <span style='color:#e34adc;'>k800_l0</span>
    <span style='color:#696969;'>; modulo 5    </span>
    <span style='color:#004a43;'>dd</span>     <span style='color:#008000;'>003020100h</span><span style='color:#808030;'>,</span> <span style='color:#008000;'>002010004h</span><span style='color:#808030;'>,</span> <span style='color:#008000;'>000000403h</span>
    <span style='color:#696969;'>; rho pi</span>
    <span style='color:#004a43;'>dd</span>     <span style='color:#008000;'>0110b070ah</span><span style='color:#808030;'>,</span> <span style='color:#008000;'>010050312h</span><span style='color:#808030;'>,</span> <span style='color:#008000;'>004181508h</span> 
    <span style='color:#004a43;'>dd</span>     <span style='color:#008000;'>00d13170fh</span><span style='color:#808030;'>,</span> <span style='color:#008000;'>00e14020ch</span><span style='color:#808030;'>,</span> <span style='color:#008000;'>001060916h</span>
<span style='color:#e34adc;'>k800_l0:</span>
    <span style='color:#800000;font-weight:bold;'>pop</span>    <span style='color:#000080;'>ebx</span>                  <span style='color:#696969;'>; m + p</span>
    <span style='color:#800000;font-weight:bold;'>push</span>   <span style='color:#008c00;'>22</span>
    <span style='color:#800000;font-weight:bold;'>pop</span>    <span style='color:#000080;'>eax</span>
    <span style='color:#800000;font-weight:bold;'>cdq</span>
    <span style='color:#800000;font-weight:bold;'>inc</span>    <span style='color:#000080;'>edx</span>                  <span style='color:#696969;'>; lfsr = 1    </span>
    <span style='color:#800000;font-weight:bold;'>pushad</span>                      <span style='color:#696969;'>; create local space</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#000080;'>edi</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>esp</span>             <span style='color:#696969;'>; edi = bc   </span>
<span style='color:#e34adc;'>k800_l1:</span>    
    <span style='color:#800000;font-weight:bold;'>push</span>   <span style='color:#000080;'>eax</span>    
    <span style='color:#800000;font-weight:bold;'>push</span>   <span style='color:#008c00;'>5</span> 
    <span style='color:#800000;font-weight:bold;'>pop</span>    <span style='color:#000080;'>ecx</span>    
    <span style='color:#800000;font-weight:bold;'>pushad</span>
<span style='color:#e34adc;'>theta_l0:</span>
    <span style='color:#696969;'>; Theta</span>
    <span style='color:#800000;font-weight:bold;'>lodsd</span>                       <span style='color:#696969;'>; t  = st[i     ];  </span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>+</span> <span style='color:#008c00;'>5</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#008c00;'>-4</span><span style='color:#808030;'>]</span>    <span style='color:#696969;'>; t ^= st[i +  5];</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>10</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#008c00;'>-4</span><span style='color:#808030;'>]</span>    <span style='color:#696969;'>; t ^= st[i + 10];</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>15</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#008c00;'>-4</span><span style='color:#808030;'>]</span>    <span style='color:#696969;'>; t ^= st[i + 15];</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>20</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#008c00;'>-4</span><span style='color:#808030;'>]</span>    <span style='color:#696969;'>; t ^= st[i + 20];</span>
    <span style='color:#800000;font-weight:bold;'>stosd</span>                       <span style='color:#696969;'>; bc[i] = t;</span>
    <span style='color:#800000;font-weight:bold;'>loop</span>   <span style='color:#e34adc;'>theta_l0</span>        
    <span style='color:#800000;font-weight:bold;'>popad</span>    
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>eax</span>    
<span style='color:#e34adc;'>theta_l1:</span>
    <span style='color:#800000;font-weight:bold;'>movzx</span>  <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>byte</span><span style='color:#808030;'>[</span><span style='color:#000080;'>ebx</span><span style='color:#808030;'>+</span><span style='color:#000080;'>eax</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span> <span style='color:#696969;'>; ebp = m[(i + 4)];</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span><span style='color:#000080;'>ebp</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>     <span style='color:#696969;'>; t   = bc[m[(i + 4)]];    </span>
    <span style='color:#800000;font-weight:bold;'>movzx</span>  <span style='color:#000080;'>edx</span><span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>byte</span><span style='color:#808030;'>[</span><span style='color:#000080;'>ebx</span><span style='color:#808030;'>+</span><span style='color:#000080;'>eax</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span> <span style='color:#696969;'>; edx = m[(i + 1)];</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#000080;'>edx</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span><span style='color:#000080;'>edx</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>     <span style='color:#696969;'>; edx = bc[m[(i + 1)]];</span>
    <span style='color:#800000;font-weight:bold;'>rol</span>    <span style='color:#000080;'>edx</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>1</span>               <span style='color:#696969;'>; t  ^= ROTL32(edx, 1);</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>edx</span>
<span style='color:#e34adc;'>theta_l2:</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>+</span><span style='color:#000080;'>eax</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ebp</span>     <span style='color:#696969;'>; st[j] ^= t;</span>
    <span style='color:#800000;font-weight:bold;'>add</span>    <span style='color:#000080;'>al</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>5</span>                <span style='color:#696969;'>; j+=5 </span>
    <span style='color:#800000;font-weight:bold;'>cmp</span>    <span style='color:#000080;'>al</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>25</span>               <span style='color:#696969;'>; j&lt;25</span>
    <span style='color:#800000;font-weight:bold;'>jb</span>     <span style='color:#e34adc;'>theta_l2</span>    
    <span style='color:#800000;font-weight:bold;'>sub</span>    <span style='color:#000080;'>al</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>24</span>               <span style='color:#696969;'>; i=i+1</span>
    <span style='color:#800000;font-weight:bold;'>loop</span>   <span style='color:#e34adc;'>theta_l1</span>             <span style='color:#696969;'>; i&lt;5 </span>
    <span style='color:#696969;'>; *************************************</span>
    <span style='color:#696969;'>; Rho Pi</span>
    <span style='color:#696969;'>; *************************************</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>       <span style='color:#696969;'>; t = st[1];</span>
<span style='color:#e34adc;'>rho_l0:</span>
    <span style='color:#800000;font-weight:bold;'>lea</span>    <span style='color:#000080;'>ecx</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>ecx</span><span style='color:#808030;'>+</span><span style='color:#000080;'>eax</span><span style='color:#808030;'>-</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>     <span style='color:#696969;'>; r = r + i + 1;</span>
    <span style='color:#800000;font-weight:bold;'>rol</span>    <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>cl</span>              <span style='color:#696969;'>; t = ROTL32(t, r); </span>
    <span style='color:#800000;font-weight:bold;'>movzx</span>  <span style='color:#000080;'>edx</span><span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>byte</span><span style='color:#808030;'>[</span><span style='color:#000080;'>ebx</span><span style='color:#808030;'>+</span><span style='color:#000080;'>eax</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>7</span><span style='color:#808030;'>]</span> <span style='color:#696969;'>; edx = p[i];</span>
    <span style='color:#800000;font-weight:bold;'>xchg</span>   <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>+</span><span style='color:#000080;'>edx</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ebp</span>     <span style='color:#696969;'>; XCHG(st[p[i]], t);</span>
    <span style='color:#800000;font-weight:bold;'>inc</span>    <span style='color:#000080;'>eax</span>                  <span style='color:#696969;'>; i++</span>
    <span style='color:#800000;font-weight:bold;'>cmp</span>    <span style='color:#000080;'>al</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>24</span><span style='color:#008c00;'>+5</span>             <span style='color:#696969;'>; i&lt;24</span>
    <span style='color:#800000;font-weight:bold;'>jnz</span>    <span style='color:#e34adc;'>rho_l0</span>               <span style='color:#696969;'>; </span>
    <span style='color:#696969;'>; *************************************</span>
    <span style='color:#696969;'>; Chi</span>
    <span style='color:#696969;'>; *************************************</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>ecx</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ecx</span>             <span style='color:#696969;'>; i = 0   </span>
<span style='color:#e34adc;'>chi_l0:</span>    
    <span style='color:#800000;font-weight:bold;'>pushad</span>
    <span style='color:#696969;'>; memcpy(&amp;bc, &amp;st[i], 5*4);</span>
    <span style='color:#800000;font-weight:bold;'>lea</span>    <span style='color:#000080;'>esi</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>+</span><span style='color:#000080;'>ecx</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>     <span style='color:#696969;'>; esi = &amp;st[i];</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#000080;'>cl</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>5</span>
    <span style='color:#800000;font-weight:bold;'>rep</span>    <span style='color:#800000;font-weight:bold;'>movsd</span>
    <span style='color:#800000;font-weight:bold;'>popad</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>eax</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>eax</span>
<span style='color:#e34adc;'>chi_l1:</span>
    <span style='color:#800000;font-weight:bold;'>movzx</span>  <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>byte</span><span style='color:#808030;'>[</span><span style='color:#000080;'>ebx</span><span style='color:#808030;'>+</span><span style='color:#000080;'>eax</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>movzx</span>  <span style='color:#000080;'>edx</span><span style='color:#808030;'>,</span> <span style='color:#800000;font-weight:bold;'>byte</span><span style='color:#808030;'>[</span><span style='color:#000080;'>ebx</span><span style='color:#808030;'>+</span><span style='color:#000080;'>eax</span><span style='color:#808030;'>+</span><span style='color:#008c00;'>2</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span><span style='color:#000080;'>ebp</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>     <span style='color:#696969;'>; t = ~bc[m[(i + 1)]] </span>
    <span style='color:#800000;font-weight:bold;'>not</span>    <span style='color:#000080;'>ebp</span>            
    <span style='color:#800000;font-weight:bold;'>and</span>    <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edi</span><span style='color:#808030;'>+</span><span style='color:#000080;'>edx</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span>
    <span style='color:#800000;font-weight:bold;'>lea</span>    <span style='color:#000080;'>edx</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>eax</span><span style='color:#808030;'>+</span><span style='color:#000080;'>ecx</span><span style='color:#808030;'>]</span>       <span style='color:#696969;'>; edx = j + i    </span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>+</span><span style='color:#000080;'>edx</span><span style='color:#808030;'>*</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ebp</span>     <span style='color:#696969;'>; st[j + i] ^= t;  </span>
    <span style='color:#800000;font-weight:bold;'>inc</span>    <span style='color:#000080;'>eax</span>                  <span style='color:#696969;'>; j++</span>
    <span style='color:#800000;font-weight:bold;'>cmp</span>    <span style='color:#000080;'>al</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>5</span>                <span style='color:#696969;'>; j&lt;5</span>
    <span style='color:#800000;font-weight:bold;'>jnz</span>    <span style='color:#e34adc;'>chi_l1</span>        
    <span style='color:#800000;font-weight:bold;'>add</span>    <span style='color:#000080;'>cl</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>al</span>               <span style='color:#696969;'>; i+=5;</span>
    <span style='color:#800000;font-weight:bold;'>cmp</span>    <span style='color:#000080;'>cl</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>25</span>               <span style='color:#696969;'>; i&lt;25</span>
    <span style='color:#800000;font-weight:bold;'>jb</span>     <span style='color:#e34adc;'>chi_l0</span>
    <span style='color:#696969;'>; Iota</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#000080;'>al</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>esp</span><span style='color:#808030;'>+</span>kws_t<span style='color:#808030;'>+</span>lfsr<span style='color:#808030;'>+</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span><span style='color:#696969;'>; al = t = *LFSR</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#000080;'>dl</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>1</span>                <span style='color:#696969;'>; i = 1</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ebp</span>
<span style='color:#e34adc;'>iota_l0:</span>    
    <span style='color:#800000;font-weight:bold;'>test</span>   <span style='color:#000080;'>al</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>1</span>                <span style='color:#696969;'>; t &amp; 1</span>
    <span style='color:#800000;font-weight:bold;'>je</span>     <span style='color:#e34adc;'>iota_l1</span>    
    <span style='color:#800000;font-weight:bold;'>lea</span>    <span style='color:#000080;'>ecx</span><span style='color:#808030;'>,</span> <span style='color:#808030;'>[</span><span style='color:#000080;'>edx</span><span style='color:#808030;'>-</span><span style='color:#008c00;'>1</span><span style='color:#808030;'>]</span>         <span style='color:#696969;'>; ecx = (i - 1)</span>
    <span style='color:#800000;font-weight:bold;'>cmp</span>    <span style='color:#000080;'>cl</span><span style='color:#808030;'>,</span> <span style='color:#008c00;'>32</span>               <span style='color:#696969;'>; skip if (ecx &gt;= 32)</span>
    <span style='color:#800000;font-weight:bold;'>jae</span>    <span style='color:#e34adc;'>iota_l1</span>    
    <span style='color:#800000;font-weight:bold;'>btc</span>    <span style='color:#000080;'>ebp</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ecx</span>             <span style='color:#696969;'>; c ^= 1UL &lt;&lt; (i - 1)</span>
<span style='color:#e34adc;'>iota_l1:</span>    
    <span style='color:#800000;font-weight:bold;'>add</span>    <span style='color:#000080;'>al</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>al</span>               <span style='color:#696969;'>; t &lt;&lt; 1</span>
    <span style='color:#800000;font-weight:bold;'>sbb</span>    <span style='color:#000080;'>ah</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ah</span>               <span style='color:#696969;'>; ah = (t &lt; 0) ? 0x00 : 0xFF</span>
    <span style='color:#800000;font-weight:bold;'>and</span>    <span style='color:#000080;'>ah</span><span style='color:#808030;'>,</span> <span style='color:#008000;'>0x71</span>             <span style='color:#696969;'>; ah = (ah == 0xFF) ? 0x71 : 0x00  </span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#000080;'>al</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ah</span>  
    <span style='color:#800000;font-weight:bold;'>add</span>    <span style='color:#000080;'>dl</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>dl</span>               <span style='color:#696969;'>; i += i</span>
    <span style='color:#800000;font-weight:bold;'>jns</span>    <span style='color:#e34adc;'>iota_l0</span>              <span style='color:#696969;'>; while (i != 128)</span>
    <span style='color:#800000;font-weight:bold;'>mov</span>    <span style='color:#808030;'>[</span><span style='color:#000080;'>esp</span><span style='color:#808030;'>+</span>kws_t<span style='color:#808030;'>+</span>lfsr<span style='color:#808030;'>+</span><span style='color:#008c00;'>4</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>al</span><span style='color:#696969;'>; save t</span>
    <span style='color:#800000;font-weight:bold;'>xor</span>    <span style='color:#808030;'>[</span><span style='color:#000080;'>esi</span><span style='color:#808030;'>]</span><span style='color:#808030;'>,</span> <span style='color:#000080;'>ebp</span>           <span style='color:#696969;'>; st[0] ^= rc(&amp;lfsr);      </span>
    <span style='color:#800000;font-weight:bold;'>pop</span>    <span style='color:#000080;'>eax</span>
    <span style='color:#800000;font-weight:bold;'>dec</span>    <span style='color:#000080;'>eax</span>
    <span style='color:#800000;font-weight:bold;'>jnz</span>    <span style='color:#e34adc;'>k800_l1</span>              <span style='color:#696969;'>; rnds&lt;22    </span>
    <span style='color:#800000;font-weight:bold;'>popad</span>                       <span style='color:#696969;'>; release bc</span>
    <span style='color:#800000;font-weight:bold;'>popad</span>                       <span style='color:#696969;'>; restore registers </span>
    <span style='color:#800000;font-weight:bold;'>ret</span>
</pre>

<h3><strong>Keccak-f[200, 18] in x86 assembly</strong></h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#696969; '>; -----------------------------------------------</span>
<span style='color:#696969; '>; Keccak-f[200, 18] in x86 assembly</span>
<span style='color:#696969; '>;</span>
<span style='color:#696969; '>; size: 210 bytes</span>
<span style='color:#696969; '>;</span>
<span style='color:#696969; '>; global calls use cdecl convention</span>
<span style='color:#696969; '>;</span>
<span style='color:#696969; '>; -----------------------------------------------</span>
    <span style='color:#004a43; '>bits</span>   <span style='color:#008c00; '>32</span>
  
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#004a43; '>%ifndef</span><span style='color:#004a43; '> BIN</span>
      <span style='color:#004a43; '>global</span> k2<span style='color:#008c00; '>00</span>
      <span style='color:#004a43; '>global</span> _k2<span style='color:#008c00; '>00</span>
<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;</span><span style='color:#004a43; '>%endif</span>
    
<span style='color:#696969; '>; void k200(void*s);    </span>
<span style='color:#e34adc; '>k200:</span>
<span style='color:#e34adc; '>_k200:</span>
    <span style='color:#800000; font-weight:bold; '>pushad</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>esi</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>esp</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>32</span><span style='color:#008c00; '>+4</span><span style='color:#808030; '>]</span>      <span style='color:#696969; '>; esi = st</span>
    <span style='color:#800000; font-weight:bold; '>pushad</span>                      <span style='color:#696969; '>; create local space</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>edi</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>esp</span>             <span style='color:#696969; '>; edi = bc </span>
    <span style='color:#800000; font-weight:bold; '>call</span>   <span style='color:#e34adc; '>k200_l0</span>
<span style='color:#e34adc; '>m:</span>
    <span style='color:#004a43; '>db</span>     <span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>2</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>4</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>2</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>3</span>
<span style='color:#e34adc; '>rc:</span>    
    <span style='color:#004a43; '>db</span>     <span style='color:#008000; '>0x01</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x82</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8a</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x00</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8b</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x01</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x81</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x09</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8a</span>
    <span style='color:#004a43; '>db</span>     <span style='color:#008000; '>0x88</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x09</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x0a</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8b</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x8b</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x89</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x03</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x02</span><span style='color:#808030; '>,</span> <span style='color:#008000; '>0x80</span>
<span style='color:#e34adc; '>p:</span>      
    <span style='color:#004a43; '>db</span>     <span style='color:#008c00; '>10</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>7</span><span style='color:#808030; '>,</span>  <span style='color:#008c00; '>11</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>17</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>18</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>,</span>  <span style='color:#008c00; '>16</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>8</span><span style='color:#808030; '>,</span>  <span style='color:#008c00; '>21</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>24</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>4</span><span style='color:#808030; '>,</span> 
    <span style='color:#004a43; '>db</span>     <span style='color:#008c00; '>15</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>23</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>19</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>13</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>12</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>2</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>20</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>14</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>22</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>9</span><span style='color:#808030; '>,</span>  <span style='color:#008c00; '>6</span><span style='color:#808030; '>,</span>  <span style='color:#008c00; '>1</span>
<span style='color:#e34adc; '>k200_l0:</span>
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>ebp</span>                  <span style='color:#696969; '>; m + p  </span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>eax</span> 
<span style='color:#e34adc; '>k200_l1:</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#000080; '>eax</span>                  <span style='color:#696969; '>; save rnd</span>
    <span style='color:#800000; font-weight:bold; '>push</span>   <span style='color:#008c00; '>5</span>
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>ecx</span>                  <span style='color:#696969; '>; loop 5 times    </span>
    <span style='color:#800000; font-weight:bold; '>pushad</span>                      <span style='color:#696969; '>; save all registers</span>
<span style='color:#e34adc; '>theta_l0:</span>
    <span style='color:#696969; '>; Theta</span>
    <span style='color:#800000; font-weight:bold; '>lodsb</span>                       <span style='color:#696969; '>; t  = st[i     ];  </span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>+</span> <span style='color:#008c00; '>5</span><span style='color:#008c00; '>-1</span><span style='color:#808030; '>]</span>       <span style='color:#696969; '>; t ^= st[i +  5];</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>10</span><span style='color:#008c00; '>-1</span><span style='color:#808030; '>]</span>       <span style='color:#696969; '>; t ^= st[i + 10];</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>15</span><span style='color:#008c00; '>-1</span><span style='color:#808030; '>]</span>       <span style='color:#696969; '>; t ^= st[i + 15];</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>20</span><span style='color:#008c00; '>-1</span><span style='color:#808030; '>]</span>       <span style='color:#696969; '>; t ^= st[i + 20];</span>
    <span style='color:#800000; font-weight:bold; '>stosb</span>                       <span style='color:#696969; '>; bc[i] = t;</span>
    <span style='color:#800000; font-weight:bold; '>loop</span>   <span style='color:#e34adc; '>theta_l0</span>        
    <span style='color:#800000; font-weight:bold; '>popad</span>                       <span style='color:#696969; '>; restore all registers</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>eax</span>             <span style='color:#696969; '>; i = 0</span>
<span style='color:#e34adc; '>theta_l1:</span>
    <span style='color:#800000; font-weight:bold; '>movzx</span>  <span style='color:#000080; '>ebx</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>ebp</span><span style='color:#808030; '>+</span><span style='color:#000080; '>eax</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>]</span> <span style='color:#696969; '>; x = m[(i + 4)];  </span>
    <span style='color:#800000; font-weight:bold; '>movzx</span>  <span style='color:#000080; '>edx</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>ebp</span><span style='color:#808030; '>+</span><span style='color:#000080; '>eax</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span> <span style='color:#696969; '>; y = m[(i + 1)];</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>edi</span><span style='color:#808030; '>+</span><span style='color:#000080; '>ebx</span><span style='color:#808030; '>]</span>    <span style='color:#696969; '>; x = bc[x];</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>edi</span><span style='color:#808030; '>+</span><span style='color:#000080; '>edx</span><span style='color:#808030; '>]</span>    <span style='color:#696969; '>; y = bc[y];</span>
    <span style='color:#800000; font-weight:bold; '>rol</span>    <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>                <span style='color:#696969; '>; y = ROTL8(y, 1);</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>dl</span>               <span style='color:#696969; '>; t = x ^ y; </span>
<span style='color:#e34adc; '>theta_l2:</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>+</span><span style='color:#000080; '>eax</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bl</span>    <span style='color:#696969; '>; st[j] ^= t;</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>                <span style='color:#696969; '>; j+=5 </span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>25</span>               <span style='color:#696969; '>; j&lt;25</span>
    <span style='color:#800000; font-weight:bold; '>jb</span>     <span style='color:#e34adc; '>theta_l2</span>    
    <span style='color:#800000; font-weight:bold; '>sub</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>24</span>               <span style='color:#696969; '>; i++</span>
    <span style='color:#800000; font-weight:bold; '>loop</span>   <span style='color:#e34adc; '>theta_l1</span>             <span style='color:#696969; '>; i&lt;5 </span>
    <span style='color:#696969; '>; *************************************</span>
    <span style='color:#696969; '>; Rho + Pi</span>
    <span style='color:#696969; '>; *************************************</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span>          <span style='color:#696969; '>; u = st[1];</span>
<span style='color:#e34adc; '>rho_l0:</span>
    <span style='color:#800000; font-weight:bold; '>lea</span>    <span style='color:#000080; '>ecx</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>ecx</span><span style='color:#808030; '>+</span><span style='color:#000080; '>eax</span><span style='color:#808030; '>-</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>]</span>     <span style='color:#696969; '>; r += i + 1;</span>
    <span style='color:#800000; font-weight:bold; '>and</span>    <span style='color:#000080; '>cl</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>7</span>    
    <span style='color:#800000; font-weight:bold; '>rol</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>cl</span>               <span style='color:#696969; '>; u = ROTL8(u, r &amp; 7); </span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>ebp</span><span style='color:#808030; '>+</span><span style='color:#000080; '>eax</span><span style='color:#808030; '>+</span><span style='color:#808030; '>(</span>p <span style='color:#808030; '>-</span> m<span style='color:#808030; '>)</span><span style='color:#008c00; '>-5</span><span style='color:#808030; '>]</span>  <span style='color:#696969; '>; x = p[i];</span>
    <span style='color:#800000; font-weight:bold; '>xchg</span>   <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>+</span><span style='color:#000080; '>edx</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bl</span>    <span style='color:#696969; '>; XCHG(st[x], u);</span>
    <span style='color:#800000; font-weight:bold; '>inc</span>    <span style='color:#000080; '>eax</span>                  <span style='color:#696969; '>; i++</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>24</span><span style='color:#008c00; '>+5</span>             <span style='color:#696969; '>; i&lt;24</span>
    <span style='color:#800000; font-weight:bold; '>jnz</span>    <span style='color:#e34adc; '>rho_l0</span>               <span style='color:#696969; '>; </span>
    <span style='color:#696969; '>; *************************************</span>
    <span style='color:#696969; '>; Chi</span>
    <span style='color:#696969; '>; *************************************</span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#000080; '>eax</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>eax</span>             <span style='color:#696969; '>; i = 0   </span>
<span style='color:#e34adc; '>chi_l0:</span>    
    <span style='color:#696969; '>; memcpy(&amp;bc, &amp;st[i], 5);</span>
    <span style='color:#800000; font-weight:bold; '>pushad</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    <span style='color:#000080; '>esi</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>eax</span>             <span style='color:#696969; '>; esi = &amp;st[i]</span>
    <span style='color:#800000; font-weight:bold; '>movsd</span>    
    <span style='color:#800000; font-weight:bold; '>movsb</span>
    <span style='color:#800000; font-weight:bold; '>popad</span>
    <span style='color:#800000; font-weight:bold; '>cdq</span>                         <span style='color:#696969; '>; j = 0</span>
<span style='color:#e34adc; '>chi_l1:</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>ebp</span><span style='color:#808030; '>+</span><span style='color:#000080; '>edx</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span>  <span style='color:#696969; '>; x = m(j + 1) </span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>cl</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>ebp</span><span style='color:#808030; '>+</span><span style='color:#000080; '>edx</span><span style='color:#808030; '>+</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>]</span>  <span style='color:#696969; '>; y = m(j + 2)</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>edi</span><span style='color:#808030; '>+</span><span style='color:#000080; '>ebx</span><span style='color:#808030; '>]</span>        <span style='color:#696969; '>; t = ~bc[x]</span>
    <span style='color:#800000; font-weight:bold; '>not</span>    <span style='color:#000080; '>bl</span>            
    <span style='color:#800000; font-weight:bold; '>and</span>    <span style='color:#000080; '>bl</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>edi</span><span style='color:#808030; '>+</span><span style='color:#000080; '>ecx</span><span style='color:#808030; '>]</span>        <span style='color:#696969; '>; t &amp;= bc[y];</span>
    <span style='color:#800000; font-weight:bold; '>lea</span>    <span style='color:#000080; '>ecx</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>eax</span><span style='color:#808030; '>+</span><span style='color:#000080; '>edx</span><span style='color:#808030; '>]</span>       <span style='color:#696969; '>; y = j + i   </span>
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>+</span><span style='color:#000080; '>ecx</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>bl</span>    <span style='color:#696969; '>; st[y] ^= t;  </span>
    <span style='color:#800000; font-weight:bold; '>inc</span>    <span style='color:#000080; '>edx</span>                  <span style='color:#696969; '>; j++</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>    <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>                <span style='color:#696969; '>; j&lt;5</span>
    <span style='color:#800000; font-weight:bold; '>jnz</span>    <span style='color:#e34adc; '>chi_l1</span>
    <span style='color:#696969; '>; *************************</span>
    <span style='color:#800000; font-weight:bold; '>add</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>dl</span>               <span style='color:#696969; '>; i+=5;</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>25</span>               <span style='color:#696969; '>; i&lt;25</span>
    <span style='color:#800000; font-weight:bold; '>jb</span>     <span style='color:#e34adc; '>chi_l0</span>   
    <span style='color:#696969; '>; *************************</span>
    <span style='color:#800000; font-weight:bold; '>pop</span>    <span style='color:#000080; '>eax</span>                  <span style='color:#696969; '>; restore rnd   </span>
    <span style='color:#800000; font-weight:bold; '>mov</span>    <span style='color:#000080; '>dl</span><span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span><span style='color:#000080; '>ebp</span><span style='color:#808030; '>+</span><span style='color:#000080; '>eax</span><span style='color:#808030; '>+</span><span style='color:#808030; '>(</span>rc <span style='color:#808030; '>-</span> m<span style='color:#808030; '>)</span><span style='color:#808030; '>]</span> 
    <span style='color:#800000; font-weight:bold; '>xor</span>    <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#000080; '>esi</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>dl</span>        <span style='color:#696969; '>; st[0] ^= rc[rnd];</span>
    <span style='color:#800000; font-weight:bold; '>inc</span>    <span style='color:#000080; '>eax</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>    <span style='color:#000080; '>al</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>18</span>    
    <span style='color:#800000; font-weight:bold; '>jnz</span>    <span style='color:#e34adc; '>k200_l1</span>              <span style='color:#696969; '>; rnd&lt;18    </span>
    <span style='color:#800000; font-weight:bold; '>popad</span>                       <span style='color:#696969; '>; release bc</span>
    <span style='color:#800000; font-weight:bold; '>popad</span>                       <span style='color:#696969; '>; restore registers </span>
    <span style='color:#800000; font-weight:bold; '>ret</span>
</pre>

<h3><strong>Keccak-f[1600,24] in ARM64 assembly</strong></h3>

<pre style='color:#000000;background:#ffffff;'><span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> keccak<span style='color:#808030; '>-</span>f<span style='color:#808030; '>[</span><span style='color:#008c00; '>1600</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>24</span><span style='color:#808030; '>]</span>
<span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#008c00; '>428</span> bytes

    .arch armv8<span style='color:#808030; '>-</span>a
    .text
    .<span style='color:#004a43; '>global</span> k1<span style='color:#008c00; '>600</span>
    
    #define s x0
    #define n x1
    #define i x2
    #define j x3
    #define r x4
    #define x x5
    #define y x6
    #define t x7
    #define Y x8
    #define <span style='color:#004a43; '>c</span> x9   <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> round constant <span style='color:#808030; '>(</span>unsigned char<span style='color:#808030; '>)</span>
    #define d x1<span style='color:#008c00; '>0</span>
    #define v x1<span style='color:#008c00; '>1</span>
    #define u x1<span style='color:#008c00; '>2</span>
    #define b <span style='color:#000080; '>sp</span>   <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#004a43; '>local</span> buffer

<span style='color:#e34adc; '>k1600:</span>
    <span style='color:#800000; font-weight:bold; '>sub</span>     <span style='color:#000080; '>sp</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>sp</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>64</span> 
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> F<span style='color:#808030; '>(</span>n<span style='color:#808030; '>,</span><span style='color:#008c00; '>24</span><span style='color:#808030; '>)</span><span style='color:#808030; '>{</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     n<span style='color:#808030; '>,</span> <span style='color:#008c00; '>24</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#004a43; '>c</span> <span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span>
<span style='color:#e34adc; '>L0:</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     d<span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> F<span style='color:#808030; '>(</span>i<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>{</span>b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span><span style='color:#808030; '>=</span><span style='color:#008c00; '>0</span><span style='color:#696969; '>;F(j,5)b[i]^=s[i+j*5];}</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
<span style='color:#e34adc; '>L1:</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     u<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
<span style='color:#e34adc; '>L2:</span>
    madd    v<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> i          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>j <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> i
    ldr     v<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> s<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span>

    eor     u<span style='color:#808030; '>,</span> u<span style='color:#808030; '>,</span> v             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> v
    
    <span style='color:#800000; font-weight:bold; '>add</span>     j<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>=</span> j <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>5</span>
    bne     L2
    
    <span style='color:#800000; font-weight:bold; '>str</span>     u<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>b<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> u
 
    <span style='color:#800000; font-weight:bold; '>add</span>     i<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>=</span> i <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>     i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>5</span>
    bne     L1
    
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> F<span style='color:#808030; '>(</span>i<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>{</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>
<span style='color:#e34adc; '>L3:</span>
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t<span style='color:#808030; '>=</span>b<span style='color:#808030; '>[</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>4</span><span style='color:#808030; '>)</span><span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span> R<span style='color:#808030; '>(</span>b<span style='color:#808030; '>[</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>63</span><span style='color:#808030; '>)</span><span style='color:#696969; '>;</span>
    <span style='color:#800000; font-weight:bold; '>add</span>     v<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>4</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> i <span style='color:#808030; '>+</span> <span style='color:#008c00; '>4</span>
    udiv    u<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> d             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>v <span style='color:#808030; '>/</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>
    msub    v<span style='color:#808030; '>,</span> u<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> v          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>v <span style='color:#808030; '>-</span> <span style='color:#808030; '>(</span>u <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
    ldr     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>b<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>=</span> b<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span>
    
    <span style='color:#800000; font-weight:bold; '>add</span>     v<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> i <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span>
    udiv    u<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> d             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>v <span style='color:#808030; '>/</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>
    msub    v<span style='color:#808030; '>,</span> u<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> v          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>v <span style='color:#808030; '>-</span> <span style='color:#808030; '>(</span>u <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>
    ldr     u<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>b<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> b<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span>

    eor     t<span style='color:#808030; '>,</span> t<span style='color:#808030; '>,</span> u<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>ror</span> <span style='color:#008c00; '>63</span>     <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> R<span style='color:#808030; '>(</span>u<span style='color:#808030; '>,</span> <span style='color:#008c00; '>63</span><span style='color:#808030; '>)</span>
    
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> F<span style='color:#808030; '>(</span>j<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>s<span style='color:#808030; '>[</span>i<span style='color:#808030; '>+</span>j<span style='color:#808030; '>*</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>t<span style='color:#696969; '>;}</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>
<span style='color:#e34adc; '>L4:</span>
    madd    v<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> i          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>j <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> i
    ldr     u<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> s<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span>
    eor     u<span style='color:#808030; '>,</span> u<span style='color:#808030; '>,</span> t             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> t
    <span style='color:#800000; font-weight:bold; '>str</span>     u<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> s<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> u 
    
    <span style='color:#800000; font-weight:bold; '>add</span>     j<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>=</span> j <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>5</span>
    bne     L4
    
    <span style='color:#800000; font-weight:bold; '>add</span>     i<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>=</span> i <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>     i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>5</span>
    bne     L3
    
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t<span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>y<span style='color:#808030; '>=</span>r<span style='color:#808030; '>=</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span>x<span style='color:#808030; '>=</span><span style='color:#008c00; '>1</span><span style='color:#696969; '>;</span>
    ldr     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>,</span> <span style='color:#008c00; '>8</span><span style='color:#808030; '>]</span>           <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>=</span> s<span style='color:#808030; '>[</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>]</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     y<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> y <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     r<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> r <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     x<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x <span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span>
    
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> F<span style='color:#808030; '>(</span>j<span style='color:#808030; '>,</span><span style='color:#008c00; '>24</span><span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span> 
<span style='color:#e34adc; '>L5:</span>
    <span style='color:#800000; font-weight:bold; '>add</span>     j<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>=</span> j <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span>
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> r<span style='color:#808030; '>+</span><span style='color:#808030; '>=</span>j<span style='color:#808030; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span>Y<span style='color:#808030; '>=</span><span style='color:#808030; '>(</span>x<span style='color:#808030; '>*</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>+</span><span style='color:#808030; '>(</span>y<span style='color:#808030; '>*</span><span style='color:#008c00; '>3</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>x<span style='color:#808030; '>=</span>y<span style='color:#808030; '>,</span>y<span style='color:#808030; '>=</span>Y<span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>,</span>
    <span style='color:#800000; font-weight:bold; '>add</span>     r<span style='color:#808030; '>,</span> r<span style='color:#808030; '>,</span> j             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> r <span style='color:#808030; '>=</span> r <span style='color:#808030; '>+</span> j
    <span style='color:#800000; font-weight:bold; '>add</span>     Y<span style='color:#808030; '>,</span> y<span style='color:#808030; '>,</span> y<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>1</span>      <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> Y <span style='color:#808030; '>=</span> y <span style='color:#808030; '>*</span> <span style='color:#008c00; '>3</span>
    <span style='color:#800000; font-weight:bold; '>add</span>     Y<span style='color:#808030; '>,</span> Y<span style='color:#808030; '>,</span> x<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>1</span>      <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> Y <span style='color:#808030; '>=</span> Y <span style='color:#808030; '>+</span> <span style='color:#808030; '>(</span>x <span style='color:#808030; '>*</span> <span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     x<span style='color:#808030; '>,</span> y                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> x <span style='color:#808030; '>=</span> y 
    udiv    y<span style='color:#808030; '>,</span> Y<span style='color:#808030; '>,</span> d             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> y <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>Y <span style='color:#808030; '>/</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>
    msub    y<span style='color:#808030; '>,</span> y<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> Y          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> y <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>Y <span style='color:#808030; '>-</span> <span style='color:#808030; '>(</span>y <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> 
    
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> Y<span style='color:#808030; '>=</span>s<span style='color:#808030; '>[</span>x<span style='color:#808030; '>+</span>y<span style='color:#808030; '>*</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>,</span>s<span style='color:#808030; '>[</span>x<span style='color:#808030; '>+</span>y<span style='color:#808030; '>*</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>=</span>R<span style='color:#808030; '>(</span>t<span style='color:#808030; '>,</span> <span style='color:#808030; '>-</span><span style='color:#808030; '>(</span>r <span style='color:#808030; '>-</span> <span style='color:#008c00; '>64</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>%</span> <span style='color:#008c00; '>64</span><span style='color:#808030; '>)</span><span style='color:#808030; '>,</span>t<span style='color:#808030; '>=</span>Y<span style='color:#696969; '>;</span>
    madd    v<span style='color:#808030; '>,</span> y<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> x          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>y <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> x
    ldr     Y<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> Y <span style='color:#808030; '>=</span> s<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span>
    <span style='color:#800000; font-weight:bold; '>neg</span>     u<span style='color:#808030; '>,</span> r 
    <span style='color:#800000; font-weight:bold; '>ror</span>     t<span style='color:#808030; '>,</span> t<span style='color:#808030; '>,</span> u             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>=</span> R<span style='color:#808030; '>(</span>t<span style='color:#808030; '>,</span> u<span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>str</span>     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> s<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> t 
    <span style='color:#800000; font-weight:bold; '>mov</span>     t<span style='color:#808030; '>,</span> Y
    
    <span style='color:#800000; font-weight:bold; '>cmp</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>24</span>               <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>24</span>
    bne     L5
    
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> F<span style='color:#808030; '>(</span>j<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>{</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
<span style='color:#e34adc; '>L6:</span>
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> F<span style='color:#808030; '>(</span>i<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> s<span style='color:#808030; '>[</span>i<span style='color:#808030; '>+</span>j<span style='color:#808030; '>*</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#696969; '>;</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
<span style='color:#e34adc; '>L7:</span>
    madd    v<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> i          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>j <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> i
    ldr     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>=</span> s<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span>
    <span style='color:#800000; font-weight:bold; '>str</span>     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>b<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> t
    
    <span style='color:#800000; font-weight:bold; '>add</span>     i<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>=</span> i <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>     i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>5</span>
    bne     L7
    
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> F<span style='color:#808030; '>(</span>i<span style='color:#808030; '>,</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
<span style='color:#e34adc; '>L8:</span>
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> s<span style='color:#808030; '>[</span>i<span style='color:#808030; '>+</span>j<span style='color:#808030; '>*</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span> <span style='color:#808030; '>^</span> <span style='color:#808030; '>(</span>b<span style='color:#808030; '>[</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span> &amp; <span style='color:#808030; '>~</span>b<span style='color:#808030; '>[</span><span style='color:#808030; '>(</span>i<span style='color:#808030; '>+</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>%</span><span style='color:#008c00; '>5</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span><span style='color:#696969; '>;}</span>
    <span style='color:#800000; font-weight:bold; '>add</span>     v<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>2</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> i <span style='color:#808030; '>+</span> <span style='color:#008c00; '>2</span> 
    udiv    u<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> d             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> v <span style='color:#808030; '>/</span> <span style='color:#008c00; '>5</span>
    msub    v<span style='color:#808030; '>,</span> u<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> v          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>v <span style='color:#808030; '>-</span> <span style='color:#808030; '>(</span>u <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> 
    ldr     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>b<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>=</span> b<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span>
    
    <span style='color:#800000; font-weight:bold; '>add</span>     v<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> i <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span>
    udiv    u<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> d             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> v <span style='color:#808030; '>/</span> <span style='color:#008c00; '>5</span> 
    msub    v<span style='color:#808030; '>,</span> u<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> v          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>v <span style='color:#808030; '>-</span> <span style='color:#808030; '>(</span>u <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> 
    ldr     u<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>b<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> b<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span>
    
    bic     u<span style='color:#808030; '>,</span> t<span style='color:#808030; '>,</span> u             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>t &amp; <span style='color:#808030; '>~</span>u<span style='color:#808030; '>)</span>
    
    ldr     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>b<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>=</span> b<span style='color:#808030; '>[</span>i<span style='color:#808030; '>]</span>
    eor     t<span style='color:#808030; '>,</span> t<span style='color:#808030; '>,</span> u             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> u
   
    madd    v<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> d<span style='color:#808030; '>,</span> i          <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>j <span style='color:#808030; '>*</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> i
    <span style='color:#800000; font-weight:bold; '>str</span>     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>3</span><span style='color:#808030; '>]</span>    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> s<span style='color:#808030; '>[</span>v<span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> t
   
    <span style='color:#800000; font-weight:bold; '>add</span>     i<span style='color:#808030; '>,</span> i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i<span style='color:#808030; '>+</span><span style='color:#808030; '>+</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>     i<span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> i <span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>5</span>
    bne     L8
   
    <span style='color:#800000; font-weight:bold; '>add</span>     j<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span>
    bne     L6
 
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> F<span style='color:#808030; '>(</span>j<span style='color:#808030; '>,</span><span style='color:#008c00; '>7</span><span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     d<span style='color:#808030; '>,</span> <span style='color:#008c00; '>113</span>
<span style='color:#e34adc; '>L9:</span>
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#004a43; '>if</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>c</span><span style='color:#808030; '>=</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>c</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#808030; '>^</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#004a43; '>c</span><span style='color:#808030; '>></span><span style='color:#808030; '>></span><span style='color:#008c00; '>7</span><span style='color:#808030; '>)</span><span style='color:#808030; '>*</span><span style='color:#008c00; '>113</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>&amp;<span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span>
    lsr     t<span style='color:#808030; '>,</span> <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>7</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>=</span> <span style='color:#004a43; '>c</span> <span style='color:#808030; '>></span><span style='color:#808030; '>></span> <span style='color:#008c00; '>7</span>
    <span style='color:#800000; font-weight:bold; '>mul</span>     t<span style='color:#808030; '>,</span> t<span style='color:#808030; '>,</span> d             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>=</span> t <span style='color:#808030; '>*</span> <span style='color:#008c00; '>113</span> 
    eor     <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> t<span style='color:#808030; '>,</span> <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>lsl</span> <span style='color:#008c00; '>1</span>      <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#004a43; '>c</span> <span style='color:#808030; '>=</span> t <span style='color:#808030; '>^</span> <span style='color:#808030; '>(</span><span style='color:#004a43; '>c</span> <span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span>
    <span style='color:#800000; font-weight:bold; '>and</span>     <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>255</span>           <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#004a43; '>c</span> <span style='color:#808030; '>=</span> <span style='color:#004a43; '>c</span> <span style='color:#808030; '>%</span> <span style='color:#008c00; '>256</span> 
    tbz     <span style='color:#004a43; '>c</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> L1<span style='color:#008c00; '>0</span>           <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> <span style='color:#004a43; '>if</span> <span style='color:#808030; '>(</span><span style='color:#004a43; '>c</span> &amp; <span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span>
    
    <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span>   <span style='color:#808030; '>*</span>s<span style='color:#808030; '>^</span><span style='color:#808030; '>=</span>1ULL<span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>(</span><span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span>j<span style='color:#808030; '>)</span><span style='color:#008c00; '>-1</span><span style='color:#808030; '>)</span><span style='color:#696969; '>;</span>
    <span style='color:#800000; font-weight:bold; '>mov</span>     v<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>lsl</span>     u<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> j             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> v <span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span> j 
    <span style='color:#800000; font-weight:bold; '>sub</span>     u<span style='color:#808030; '>,</span> u<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> u <span style='color:#808030; '>=</span> u <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>lsl</span>     v<span style='color:#808030; '>,</span> v<span style='color:#808030; '>,</span> u             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> v <span style='color:#808030; '>=</span> v <span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span> u
    ldr     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>]</span>              <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>=</span> s<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span>
    eor     t<span style='color:#808030; '>,</span> t<span style='color:#808030; '>,</span> v             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> t <span style='color:#808030; '>^</span><span style='color:#808030; '>=</span> v
    <span style='color:#800000; font-weight:bold; '>str</span>     t<span style='color:#808030; '>,</span> <span style='color:#808030; '>[</span>s<span style='color:#808030; '>]</span>              <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> s<span style='color:#808030; '>[</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> t
<span style='color:#e34adc; '>L10:</span>    
    <span style='color:#800000; font-weight:bold; '>add</span>     j<span style='color:#808030; '>,</span> j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>=</span> j <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span>
    <span style='color:#800000; font-weight:bold; '>cmp</span>     j<span style='color:#808030; '>,</span> <span style='color:#008c00; '>7</span>                <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> j <span style='color:#808030; '>&lt;</span> <span style='color:#008c00; '>7</span>
    bne     L9
    
    subs    n<span style='color:#808030; '>,</span> n<span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span>             <span style='color:#808030; '>/</span><span style='color:#808030; '>/</span> n <span style='color:#808030; '>=</span> n <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span>
    bne     L0
    
    <span style='color:#800000; font-weight:bold; '>add</span>     <span style='color:#000080; '>sp</span><span style='color:#808030; '>,</span> <span style='color:#000080; '>sp</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>64</span> 
    <span style='color:#800000; font-weight:bold; '>ret</span>
</pre>

<p><a href="https://github.com/odzhan/tinycrypt/tree/master/permutation/keccak">Sources here.</a></p>
